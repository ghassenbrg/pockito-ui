<div class="transactions-container">
  <!-- Page Header -->
  <app-page-header 
    [config]="headerConfig"
    (buttonClick)="createTransaction()"
    (secondaryButtonClick)="onSecondaryButtonClick()"
  ></app-page-header>

  <!-- View Switcher -->
  <div class="view-switcher">
    <div class="view-buttons">
      <button 
        class="view-btn" 
        [class.active]="(currentViewMode$ | async) === 'list'"
        (click)="onViewModeChange('list')"
        [pTooltip]="'transaction.view_list' | translate">
        <i class="pi pi-list"></i>
      </button>
      <button 
        class="view-btn" 
        [class.active]="(currentViewMode$ | async) === 'cards'"
        (click)="onViewModeChange('cards')"
        [pTooltip]="'transaction.view_cards' | translate">
        <i class="pi pi-th-large"></i>
      </button>
    </div>
  </div>

  <!-- Transaction Filters -->
  <div class="filters-section" *ngIf="formData$ | async as formData">
    <app-transaction-filters
      [wallets]="formData.wallets"
      [categories]="formData.categories"
      [currentFilters]="(filters$ | async) || {}"
      (filtersChange)="onFiltersChange($event)"
      (clearFilters)="onClearFilters()">
    </app-transaction-filters>
  </div>

  <!-- Transactions Content -->
  <div class="transactions-content">
    <!-- Card Mode (Desktop) -->
    <div class="transactions-grid" [class.hidden]="(currentViewMode$ | async) === 'list'">
      <app-transaction-card
        *ngFor="let transaction of transactions$ | async; trackBy: trackByTransactionId"
        [transaction]="transaction"
        (viewTransaction)="onViewTransaction($event)"
        (editTransaction)="onEditTransaction($event)"
        (deleteTransaction)="onDeleteTransaction($event)">
      </app-transaction-card>
    </div>

    <!-- List Mode (Mobile) -->
    <div class="transactions-list" [class.hidden]="(currentViewMode$ | async) === 'cards'">
      <app-transaction-list-item
        *ngFor="let transaction of transactions$ | async; trackBy: trackByTransactionId"
        [transaction]="transaction"
        (viewTransaction)="onViewTransaction($event)"
        (editTransaction)="onEditTransaction($event)"
        (deleteTransaction)="onDeleteTransaction($event)">
      </app-transaction-list-item>
    </div>

    <!-- Empty State -->
    <div class="empty-state" *ngIf="(transactions$ | async)?.length === 0">
      <div class="empty-icon">
        <i class="pi pi-credit-card"></i>
      </div>
      <h3 class="empty-title">{{ 'transaction.empty_state.title' | translate }}</h3>
      <p class="empty-description">
        {{ 'transaction.empty_state.description' | translate }}
      </p>
      <button 
        class="empty-action" 
        pButton 
        (click)="createTransaction()"
        [label]="'transaction.new_transaction' | translate"
        icon="pi pi-plus"
        class="p-button-primary">
      </button>
    </div>
  </div>

  <!-- Pagination -->
  <app-transaction-pagination
    [paginationInfo]="paginationInfo$ | async"
    [loading]="(transactionFacade.isLoadingTransactions$ | async) || false"
    (pageChange)="onPageChange($event)"
    (pageSizeChange)="onPageSizeChange($event)">
  </app-transaction-pagination>
</div>

<!-- Transaction Modal -->
<app-transaction-modal
  [visible]="showModal"
  [mode]="modalMode"
  [transaction]="selectedTransaction"
  (visibleChange)="onModalClose()"
  (transactionSaved)="onTransactionSaved()">
</app-transaction-modal>
